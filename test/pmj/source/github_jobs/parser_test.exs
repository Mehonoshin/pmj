defmodule Pmj.Source.GithubJobs.ParserTest do
  use ExUnit.Case

  alias Pmj.Source.GithubJobs.Parser
  doctest Pmj.Source.GithubJobs.Parser

  describe "first entry" do
    setup do
      [position | _] = Parser.parse
      {:ok, position: position}
    end

    test "title", context do
      assert context[:position].title == "DevOps Specialist"
    end

    test "company", context do
      assert context[:position].company == "PageFreezer Software Inc"
    end

    test "company_url", context do
      assert context[:position].company_url == "http://www.pagefreezer.com"
    end

    test "description", context do
      assert context[:position].description == "<p><strong>Who we’re looking for:</strong>\nDo you agree that security is the most important aspect of an app? Are you fascinated by scalability? We’re looking for a Development Operations Specialist with Sys Admin knowledge to join our Product Development team, working closely with them to ensure a positive, delightful experience for each of our customers.</p>\n\n<p>Scaling and improving our database infrastructure is the main focus of this position. Collaborating with our engineers, the DevOps Specialist will ensure our databases remain stable, reliable, and recoverable.</p>\n\n<p>To be successful in the role, you should be able to solve production problems and maintain database performance to meet our company’s needs. You should also possess experience with web production environments and a passion for security.</p>\n\n<p>This is a full time position as part of our Product Development team in our Gastown, Vancouver office, with a starting salary based on qualifications. Priority will be placed on local applicants, but we will consider applicants located in Seattle, Washington for remote contractor work.</p>\n\n<p><strong>A day in the job entails:</strong></p>\n\n<ul>\n<li><p>Collaborating with the IT and Product Development teams to ensure integrity, security, and ongoing performance of our infrastructure, including identifying and fixing programming changes, errors, and subsequent modifications.</p></li>\n<li><p>Monitoring, assessing, and maintaining the SaaS infrastructure such as storage, security, and servers, with a focus on our Cassandra database, Elasticsearch, and Docker Swarm for optimal operation</p></li>\n<li><p>Performing/scheduling/maintaining daily backup operations, including hardware and software upgrades and database normalization and replication procedures.</p></li>\n<li><p>Fixing errors and system issues via periodic testing, help desk tickets, and other methods</p></li>\n<li><p>Using and maintaining tools that automate system health checks</p></li>\n<li><p>Researching and recommending improvements to the organization’s hardware, software and infrastructure.</p></li>\n<li><p>Testing and installing issued patches in conjunction with software providers and vendors or other third parties.</p></li>\n<li><p>Ensuring that hardware is adequately sized and configured by conducting planning scenarios to meet future needs.</p></li>\n<li><p>Creating and updating disaster recovery plan or other security policies, as well as implementing and advocating for them across the business</p></li>\n<li><p>Managing and monitoring user accounts, creating, updating and removing access as necessary.</p></li>\n<li><p>Acting as a consultant to the team as a technical resource on new applications or potential system enhancements in support of future requirements or developments</p></li>\n</ul><p><strong>You’ll be a great match if you have:</strong></p>\n\n<ul>\n<li><p>2+ years of experience in Systems Administration with an understanding of the application process and metrics to monitor resource usage</p></li>\n<li><p>Strong knowledge of system design, analysis, installation, backup, recovery, storage management, methodologies, processes, and tools.</p></li>\n<li><p>Solid experience with Cassandra, Elastic Search, Docker, Docker Swarm, HDFS/Hadoop, MySQL, CQL,</p></li>\n<li><p>Scripting skills with Bash and Python, or other similar scripting tools</p></li>\n<li><p>Experience with networking TCP/IP protocols</p></li>\n<li><p>Practical working knowledge of Linux</p></li>\n<li><p>Ability to write concise and accurate documentation</p></li>\n<li><p>Critical thinking skills and a natural avoidance of taking shortcuts</p></li>\n<li><p>Trustworthiness and the ability form meaningful working relationships</p></li>\n<li><p>Excellent written and verbal communication skills</p></li>\n<li><p>An innovative mindset that leads to solutions</p></li>\n<li><p>Good sense of ownership and accountability</p></li>\n<li><p>A Bachelor’s or equivalent in Computer Science or Computer Engineering</p></li>\n</ul><p><strong>You’ll jump to the front of the line if you have:</strong></p>\n\n<ul>\n<li><p>An M.Sc. or Ph.D. in Computer Science or Computer Engineering</p></li>\n<li><p>3+ years of experience as a Systems Administrator</p></li>\n<li><p>Familiarity or experience with  Relational and Non-Relational Database Technologies: MySQL/Percona, NoSQL,</p></li>\n<li><p>Software development skills in Python, Java, Go JavaVM settings, and Python interpreter</p></li>\n<li><p>A passion for delighting customers</p></li>\n<li><p>A belief that leadership is attitude and teamwork makes the dream work</p></li>\n<li><p>An adaptable game plan and an ear for coaching</p></li>\n<li><p>A knack for doing more with less, but better than the rest</p></li>\n<li><p>A self-starter attitude with the discipline and commitment to meet your deadlines</p></li>\n<li><p>An insatiable desire to keep learning and growing</p></li>\n<li><p>Strong analytical thinking and time management skills</p></li>\n</ul><p><strong>You’ll want to work with us because:</strong></p>\n\n<ul>\n<li><p>Working at PageFreezer, you’ll be part of the team that provides the leading website and social media archiving solution, helping governments, fortune 500s, financial services firms, and more organizations collect and preserve their online conversations to comply with regulatory laws, stay out of legal trouble, and focus on what it is they do best.</p></li>\n<li><p>We take care of you! We offer a competitive compensation package, extended health benefits and a matching Retirement Savings Plan. Our office includes a killer view, lovable office dog, and a culture that values flexibility, real work/life balance, and trust.</p></li>\n<li><p>This job is open to anyone authorized to work in Canada or those aspiring to do so who are capable of obtaining necessary work authorization.  We strongly believe that a diverse team is key to making us a successful company.</p></li>\n</ul>"
    end

    test "url", context do
      assert context[:position].url == "http://jobs.github.com/positions/ecee8d3c-296f-11e8-9d1e-a1b3259f11e8"
    end
  end
end
